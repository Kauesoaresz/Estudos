<%- include("partials/header", { tituloPagina }) %>

<section class="kst-section">

  <!-- Cabeçalho da página -->
  <div class="kst-home-header" style="margin-bottom: 2rem;">
    <h1 class="kst-home-title">Matérias</h1>
    <p class="kst-home-subtitle">
      Todas as matérias cadastradas para organizar seus estudos.
    </p>
  </div>

  <!-- ALERTAS -->
  <% if (erroExcluir) { %>
    <div class="kst-alert kst-alert-error" style="margin-bottom: 1.2rem;">
      Não é possível excluir uma matéria que já possui estudos registrados.
    </div>
  <% } %>

  <% if (erro) { %>
    <div class="kst-alert kst-alert-error" style="margin-bottom: 1rem;">
      Informe um nome válido.
    </div>
  <% } %>

  <% if (sucesso) { %>
    <div class="kst-alert kst-alert-success" style="margin-bottom: 1rem;">
      Matéria cadastrada com sucesso!
    </div>
  <% } %>

  <!-- CARD DE ADIÇÃO -->
  <div class="kst-card" style="padding: 1.6rem; margin-bottom: 2rem;">
    <h3 class="kst-card-title" style="margin-bottom: 1rem;">Adicionar nova matéria</h3>

    <form action="/materias" method="post" class="kst-form-inline">
      <input
        type="text"
        name="nome"
        placeholder="Ex.: Matemática"
        class="kst-input"
        required
        style="max-width: 320px;"
      />
      <button type="submit" class="kst-btn kst-btn-primary">Adicionar</button>
    </form>
  </div>

  <!-- LISTA DE MATÉRIAS -->
  <% if (!materias || materias.length === 0) { %>

    <div class="kst-card" style="padding: 1.6rem; text-align: center;">
      <p style="margin: 0 0 1rem;">Nenhuma matéria cadastrada ainda.</p>
      <p style="color: var(--kst-text-soft);">Comece adicionando uma matéria acima.</p>
    </div>

  <% } else { %>

    <div class="kst-card" style="padding: 0; overflow: hidden;">
      <table class="kst-table">
        <thead>
          <tr>
            <th style="width: 70%;">Matéria</th>
            <th style="text-align: center;">Ações</th>
          </tr>
        </thead>

        <tbody>
          <% materias.forEach(function(m) { %>
            <tr>
              <td style="font-weight: 600;"><%= m.nome %></td>

              <td style="text-align:center;">

                <div class="kst-table-actions-links">
  <a href="/materias/<%= m.id %>" class="kst-link-inline">Ver</a>
  <span class="kst-sep">|</span>
  
  <a href="/materias/<%= m.id %>/editar" class="kst-link-inline">Editar</a>
  <span class="kst-sep">|</span>

  <form action="/materias/<%= m.id %>/excluir" method="post" style="display:inline;" onsubmit="return confirm('Tem certeza que deseja excluir esta matéria?');">
    <button type="submit" class="kst-link-inline kst-link-danger">Excluir</button>
  </form>
</div>


              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

  <% } %>

</section>

<%- include("partials/footer") %>
