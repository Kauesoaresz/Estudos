<%- include("partials/header", { tituloPagina: tituloPagina }) %>

<link rel="stylesheet" href="/css/pages/estudos_detalhes.css">

<section class="kst-study-details-wrapper">

  <!-- Cabe√ßalho -->
  <div class="kst-study-header">
    <h1 class="kst-study-title">Detalhes do Estudo</h1>
    <p class="kst-study-subtitle">
      Informa√ß√µes completas do bloco de estudo realizado.
    </p>
  </div>

  <!-- CARD PRINCIPAL -->
  <div class="kst-study-main-card">

    <!-- GRID SUPERIOR -->
    <div class="kst-study-grid">

      <!-- INFORMA√á√ïES GERAIS -->
      <div class="kst-study-mini-card">
        <h4>Informa√ß√µes gerais</h4>

        <p>üìÖ <strong>Data:</strong> 
          <%= estudo.dia ? estudo.dia.data : "-" %>
        </p>

        <p>üìò <strong>Mat√©ria:</strong> 
          <%= estudo.materia ? estudo.materia.nome : "-" %>
        </p>

        <p>‚è± <strong>Tempo de estudo:</strong> 
          <%= estudo.minutos_estudados != null ? estudo.minutos_estudados + " min" : "-" %>
        </p>

        <p><strong>Tipo de estudo:</strong>
          <% if (estudo.tipo_estudo === "CONTEUDO_NOVO") { %>
            <span class="kst-badge-tipo-estudo kst-badge--novo">CONTE√öDO</span>
          <% } else if (estudo.tipo_estudo === "REVISAO") { %>
            <span class="kst-badge-tipo-estudo kst-badge--revisao">REVIS√ÉO</span>
          <% } else if (estudo.tipo_estudo === "REVISAO_ERRO") { %>
            <span class="kst-badge-tipo-estudo kst-badge--erro">REVIS√ÉO DE ERRO</span>
          <% } else { %>
            -
          <% } %>
        </p>
      </div>

      <!-- QUEST√ïES -->
      <div class="kst-study-mini-card">
        <h4>Quest√µes</h4>

        <p><strong>Total feitas:</strong> 
          <%= estudo.questoes_feitas != null ? estudo.questoes_feitas : "-" %>
        </p>

        <p><strong>Certas:</strong> 
          <%= estudo.questoes_certas != null ? estudo.questoes_certas : "-" %>
        </p>

        <p><strong>Marcadas para revis√£o:</strong> 
          <%= estudo.questoes_marcadas_revisao != null ? estudo.questoes_marcadas_revisao : "-" %>
        </p>

        <!-- TAXA DE ACERTO -->
        <p><strong>Taxa de acerto:</strong>
          <% if (estudo.questoes_feitas && estudo.questoes_certas != null) { 
               const taxa = Math.round((estudo.questoes_certas / estudo.questoes_feitas) * 100); 
          %>
            <% if (taxa >= 70) { %>
              <span class="kst-badge-acerto kst-acerto-alto"><%= taxa %>%</span>
            <% } else if (taxa >= 40) { %>
              <span class="kst-badge-acerto kst-acerto-medio"><%= taxa %>%</span>
            <% } else { %>
              <span class="kst-badge-acerto kst-acerto-baixo"><%= taxa %>%</span>
            <% } %>
          <% } else { %>
            -
          <% } %>
        </p>

      </div>
    </div> <!-- fim grid -->

    <!-- T√ìPICOS -->
    <h3 class="kst-study-section-title">T√≥picos estudados</h3>

    <div class="kst-study-topicos">
      <%= estudo.topicos_estudados || "-" %>
    </div>

  </div> <!-- fim card -->

  <!-- A√á√ïES -->
  <div class="kst-study-actions">
    <a href="/estudos" class="kst-btn kst-btn-secondary">Voltar ao hist√≥rico</a>
    <a href="/estudos/<%= estudo.id %>/editar" class="kst-btn kst-btn-primary">Editar estudo</a>
  </div>

</section>

<%- include("partials/footer") %>
