<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= tituloPagina %></title>

  <!-- CSS exclusivo da rotina -->
  <link rel="stylesheet" href="/css/pages/rotina.css">
</head>

<body class="page-rotina">

  <div class="rotina-top-bar">
  <a href="/" class="btn-voltar">‚Üê Voltar ao painel</a>

  <!-- BOT√ÉO TEMA CLARO/ESCURO -->
  <button id="toggle-theme" class="theme-toggle-btn">
    üåô
  </button>
</div>


  <section class="kst-rotina">

    <!-- HEADER DA P√ÅGINA -->
    <header class="rotina-header">
      <div class="rotina-header-left">
        <h1 class="rotina-title">Rotina</h1>
        <p class="rotina-subtitle">
          Sua semana ideal, com hor√°rios fixos para acordar, estudar, treinar e descansar.
        </p>
      </div>
    </header>

    <!-- GRID DE DIAS -->
    <div class="kst-rotina-grid">

      <% diasSemana.forEach((dia, i) => { %>
        <div class="rotina-day">

          <!-- T√≠tulo do dia + linha -->
          <div class="day-header">
            <span class="day-name"><%= dia.label.toUpperCase() %></span>
          </div>

          <!-- Timeline vertical -->
          <div class="day-timeline">

            <% if (!rotinaPorDia[i].length) { %>
              <div class="day-empty">
                Nenhum bloco definido para este dia.
              </div>
            <% } else { %>

              <% rotinaPorDia[i].forEach((b) => { %>
                <div class="routine-block" style="--block-color: <%= b.color || '#1C9AFF' %>">

                  <div class="routine-label">
                    <span><%= b.title %></span>
                  </div>

                  <div class="routine-time">
                    <span><%= b.startTime %></span><br>
                    <span><%= b.endTime %></span>
                  </div>

                  <% if (b.description) { %>
                    <div class="routine-desc"><%= b.description %></div>
                  <% } %>

                  <div class="routine-actions">
                    <a href="/rotina/<%= b.id %>/editar" class="btn-xs">Editar</a>

                    <form action="/rotina/<%= b.id %>/excluir"
                          method="POST"
                          onsubmit="return confirm('Excluir este bloco?');">
                      <button type="submit" class="btn-xs btn-danger">Excluir</button>
                    </form>

                    <form action="/rotina/<%= b.id %>/duplicar"
                          method="POST"
                          class="dup-form">
                      <select name="targetWeekday" class="select-xs">
                        <% diasSemana.forEach(d => { %>
                          <option value="<%= d.value %>" <%= d.value === b.weekday ? 'disabled' : '' %>>
                            <%= d.short %>
                          </option>
                        <% }) %>
                      </select>

                      <button type="submit" class="btn-xs">Duplicar</button>
                    </form>
                  </div>
                </div>
              <% }) %>

            <% } %>

          </div>

          <!-- Bot√£o de adicionar bloco para o dia -->
          <a href="/rotina/novo?weekday=<%= dia.value %>" class="btn-secondary add-btn">
            + Bloco para <%= dia.short %>
          </a>

        </div>
      <% }) %>

    </div>
  </section>

  <script src="/js/theme.js"></script>


</body>
</html>
