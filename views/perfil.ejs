<%- include("partials/header", { tituloPagina }) %>

<div class="perfil-wrapper">

    <h1 class="perfil-title">Meu Perfil</h1>

    <div class="perfil-info">

        <!-- FOTO DO USUÁRIO -->
        <div class="perfil-photo-box">
            <img 
                src="<%= usuario.foto ? '/uploads/' + usuario.foto : '/img/default-user.png' %>" 
                class="perfil-photo"
                alt="Foto do usuário">
        </div>

        <!-- DADOS DO USUÁRIO -->
        <div class="perfil-user-text">
            <h2><%= usuario.nome %></h2>
            <p><%= usuario.email %></p>
        </div>

    </div>

    <!-- FORM DE TROCA DE FOTO -->
    <form action="/perfil/foto" method="POST" enctype="multipart/form-data" class="perfil-form">

        <input type="file" id="inputFoto" name="foto" accept="image/*" style="display: none;">

        <button type="button"
                class="perfil-btn perfil-btn-neutral"
                onclick="document.getElementById('inputFoto').click()">
            Escolher nova foto
        </button>

        <button type="submit" class="perfil-btn perfil-btn-primary">
            Salvar nova foto
        </button>

    </form>

    <!-- VOLTAR -->
    <a href="/dias" class="perfil-back">Voltar ao início</a>

</div>

<script>
    // PRÉ-VISUALIZAÇÃO DA IMAGEM
    document.getElementById("inputFoto").addEventListener("change", function () {
        const file = this.files[0];
        if (file) {
            document.querySelector(".perfil-photo").src = URL.createObjectURL(file);
        }
    });
</script>

<%- include("partials/footer") %>
